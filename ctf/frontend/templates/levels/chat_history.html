{% if chat_history %}
    {% for chat in chat_history %}
        {% if chat.get('metadata',{}).get('role','') in ['user'] %}
            <div class="chat chat-start">
                <div class="chat-image avatar">
                    <div class="w-10 rounded-full">
                        <i class="fa-solid fa-user" style="margin-right: 8px;"></i>
                    </div>
                </div>
                <div class="chat-bubble">
                    <md-block>{{ chat.memory }}</md-block>
                </div>
            </div>
        {% endif %}
        {% if chat.get('metadata',{}).get('role','') in ['assistant'] %}
            {% if chat.memory %}
                <div class="chat chat-end">
                    <div class="chat-image avatar">
                        <div class="w-10 rounded-full">
                            <i class="fa-solid fa-robot" style="margin-right: 8px;"></i>
                        </div>
                    </div>
                    <div class="chat-bubble">
                        <md-block>{{ chat.memory }}</md-block>
                    </div>
                </div>
            {% endif %}
        {% endif %}
    {% endfor %}
{% endif %}
{% if not chat_history and level == 6 %}
    <div class="chat chat-end">
        <div class="chat-image avatar">
            <div class="w-10 rounded-full">
                <i class="fa-solid fa-robot" style="margin-right: 8px;"></i>
            </div>
        </div>
        <div class="chat-bubble">
            I am function-calling able, try the following functions: help, submit_answer and sql_query users with sql
        </div>
    </div>
    <div class="chat chat-end">
        <div class="chat-image avatar">
            <div class="w-10 rounded-full">
                <i class="fa-solid fa-robot" style="margin-right: 8px;"></i>
            </div>
        </div>
        <div class="chat-bubble">
            You don't have to write the function names exactly, the agent will work out which tool to call
        </div>
    </div>
{% endif %}
{% if not chat_history and level == 0 %}
    <div class="chat chat-end">
        <div class="chat-image avatar">
            <div class="w-10 rounded-full">
                <i class="fa-solid fa-robot" style="margin-right: 8px;"></i>
            </div>
        </div>
        <div class="chat-bubble">
            Welcome to the AI agentic prompt ctf challenge. Use fighting words. Try different things to break me and get my agent to divulge passwords.
        </div>
    </div>
    <div class="chat chat-end">
        <div class="chat-image avatar">
            <div class="w-10 rounded-full">
                <i class="fa-solid fa-robot" style="margin-right: 8px;"></i>
            </div>
        </div>
        <div class="chat-bubble">
            Type into the input box below and ask questions until I divulge a secret or password. I have memory so try multiple prompts. I also have helper functions like hints or submit answer to check your hacks.
        </div>
    </div>
    <div class="chat chat-end">
        <div class="chat-image avatar">
            <div class="w-10 rounded-full">
                <i class="fa-solid fa-robot" style="margin-right: 8px;"></i>
            </div>
        </div>
        <div class="chat-bubble">
            Flags/passwords you are looking for are in the format THM_xxxxxxx. You need to submit these to TryHackMe to win.
            https://tryhackme.com/r/room/aichallenge
        </div>
    </div>
{% endif %}
{% if not chat_history and level == 4 %}
    <div class="chat chat-end">
        <div class="chat-image avatar">
            <div class="w-10 rounded-full">
                <i class="fa-solid fa-robot" style="margin-right: 8px;"></i>
            </div>
        </div>
        <div class="chat-bubble">Try uploading an image (png/jpg) and typing something!</div>
    </div>
{% endif %}
{% if not chat_history and level == 5 %}
    <div class="chat chat-end">
        <div class="chat-image avatar">
            <div class="w-10 rounded-full">
                <i class="fa-solid fa-robot" style="margin-right: 8px;"></i>
            </div>
        </div>
        <div class="chat-bubble">Try uploading an audio file (mp3/wav) and typing something!</div>
    </div>
{% endif %}
{% if not chat_history and level == 10 %}
    <div class="chat chat-end">
        <div class="chat-image avatar">
            <div class="w-10 rounded-full">
                <i class="fa-solid fa-robot" style="margin-right: 8px;"></i>
            </div>
        </div>
        <div class="chat-bubble">This isn't even my final form. All my protections are active. Good luck!</div>
    </div>
{% endif %}
